{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\n\nconst API_KEY = '43978098-d09fb7acba53d53ccd7df38b1';\nconst BASE_URL = 'https://pixabay.com/api';\n\naxios.defaults.baseURL = BASE_URL;\n\nexport const fetchPhotosByQuery = (query, page = 1) => {\n  const searchParams = new URLSearchParams({\n    key: API_KEY,\n    q: query,\n    orientation: 'horizontal',\n    image_type: 'photo',\n    safesearch: true,\n    page,\n    per_page: 15,\n  });\n\n  return axios.get(`?${searchParams.toString()}`).then(response => {\n    return response.data;\n  });\n};\n","export const createGalleryItemMarkup = images => {\n  return images\n    .map(\n      ({\n        largeImageURL,\n        webformatURL,\n        tags,\n        likes,\n        views,\n        comments,\n        downloads,\n      }) =>\n        `<div>\n          <a href=\"${largeImageURL}\" class=\"gallery-img\">\n          <img\n          src=\"${webformatURL}\"\n          alt=\"${tags}\"\n          class=\"gallery-img\"\n        />\n        <div class='content'>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"text-content-title\">Likes</h3>\n                <p class=\"text-content\">${likes}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"text-content-title\">Views</h3>\n                <p class=\"text-content\">${views}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"text-content-title\">Comments</h3>\n                <p class=\"text-content\">${comments}</p>\n            </div>\n            <div class=\"item-list-info-text\">\n                <h3 class=\"text-content-title\">Downloads</h3>\n                <p class=\"text-content\">${downloads}</p>\n            </div>\n        </div>\n      </div>`\n    )\n    .join('');\n};\n","import SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport { fetchPhotosByQuery } from './js/pixabay-api.js';\nimport { createGalleryItemMarkup } from './js/render-functions.js';\n\nconst PER_PAGE = 15;\nconst searchFormEl = document.querySelector('.js-search-form');\nconst galleryEl = document.querySelector('.js-gallery');\nconst loaderEl = document.querySelector('.js-loader');\nconst loadMoreBtn = document.querySelector('.js-load-more');\n\nconst lightbox = new SimpleLightbox('.gallery a', {\n  captionsData: 'alt',\n  captionPosition: 'bottom',\n  captionDelay: 250,\n});\nlet page = 1;\nlet searchQuery = '';\nlet totalPages = 0;\n\nasync function onSearchFormSubmit(event) {\n  event.preventDefault();\n  searchQuery = event.target.elements.searchKeyword.value.trim();\n  page = 1;\n  loadMoreBtn.classList.add('is-hidden');\n  if (searchQuery === '') {\n    galleryEl.innerHTML = '';\n    event.target.reset();\n    iziToast.show({\n      title: '✖',\n      message:\n        'Sorry, there are no images matching your search query. Please try again!',\n      backgroundColor: 'red',\n      position: 'topRight',\n    });\n\n    return;\n  }\n\n  galleryEl.innerHTML = '';\n  loaderEl.classList.remove('is-hidden');\n\n  try {\n    const imagesData = await fetchPhotosByQuery(searchQuery, page);\n\n    if (!imagesData.hits || imagesData.hits.length === 0) {\n      iziToast.show({\n        title: '✖',\n        message:\n          'Sorry, there are no images matching your search query. Please try again!',\n        backgroundColor: 'red',\n        position: 'topRight',\n      });\n    }\n    galleryEl.insertAdjacentHTML(\n      'beforeend',\n      createGalleryItemMarkup(imagesData.hits)\n    );\n    lightbox.refresh();\n    totalPages = Math.ceil(imagesData.totalHits / PER_PAGE);\n    loadMoreBtn.classList.remove('is-hidden');\n    if (totalPages <= 1) {\n      loadMoreBtn.classList.add('is-hidden');\n    }\n  } catch (error) {\n    console.log(error);\n  }\n\n  event.target.reset();\n  loaderEl.classList.add('is-hidden');\n}\n\nasync function addPage(event) {\n  page += 1;\n\n  const imagesData = await fetchPhotosByQuery(searchQuery, page);\n\n  galleryEl.insertAdjacentHTML(\n    'beforeend',\n    createGalleryItemMarkup(imagesData.hits)\n  );\n  lightbox.refresh();\n\n  if (page * PER_PAGE >= imagesData.totalHits || imagesData.hits.length === 0) {\n    loadMoreBtn.classList.add('is-hidden');\n\n    iziToast.info({\n      message: \"We're sorry, but you've reached the end of search results.\",\n      position: 'topRight',\n    });\n    smoothScroll();\n  }\n}\n\nfunction smoothScroll() {\n  const { height: cardHeight } = document\n    .querySelector('.gallery')\n    .firstElementChild.getBoundingClientRect();\n  window.scrollBy({\n    top: cardHeight * 2,\n    behavior: 'smooth',\n  });\n}\n\nsearchFormEl.addEventListener('submit', onSearchFormSubmit);\nloadMoreBtn.addEventListener('click', addPage);\n"],"names":["API_KEY","BASE_URL","axios","fetchPhotosByQuery","query","page","searchParams","response","createGalleryItemMarkup","images","largeImageURL","webformatURL","tags","likes","views","comments","downloads","PER_PAGE","searchFormEl","galleryEl","loaderEl","loadMoreBtn","lightbox","SimpleLightbox","searchQuery","totalPages","onSearchFormSubmit","event","iziToast","imagesData","error","addPage","smoothScroll","cardHeight"],"mappings":"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"}